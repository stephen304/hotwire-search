"use strict";angular.module("hotwireSearchApp",["ui.router","ui.bootstrap","angular-loading-bar","ngAnimate","ngAria"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/search"),a.state("search",{url:"/search",templateUrl:"views/search.html",controller:"SearchCtrl"}).state("search.results",{url:"/results",templateUrl:"views/results.html",controller:"ResultsCtrl"}).state("search.car",{url:"/:id",templateUrl:"views/car.html",controller:"CarCtrl"})}]).constant("cfg",{apiUrl:"https://api.hotwire.com/v1",apiKey:"cuaj6ejw7dh8je7mjffawr6a",dateRange:330,defaultDuration:7}),angular.module("hotwireSearchApp").controller("SearchCtrl",["cfg","$scope","searchService",function(a,b,c){b.minDate=new Date,b.maxDate=new Date(new Date(b.minDate.getTime()).setDate(b.minDate.getDate()+a.dateRange)),b.dateStart={val:new Date((new Date).setDate(b.minDate.getDate()+1)),opened:!1,open:function(){this.opened=!0}},b.dateEnd={val:new Date((new Date).setDate(b.minDate.getDate()+a.defaultDuration)),opened:!1,open:function(){this.opened=!0}};var d=new Date;d.setHours(12),d.setMinutes(0),b.timeStart=new Date(d.getTime()),b.timeEnd=new Date(d.getTime()),b.submit=function(){c.submit(b.location,b.dateStart.val,b.timeStart,b.dateEnd.val,b.timeEnd)},this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("hotwireSearchApp").controller("ResultsCtrl",["$scope","searchService","alertService",function(a,b,c){a.results=b.results,0===a.results.length&&c.set("No results!","warning"),b.subscribe(a,function(){a.results=b.results}),this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("hotwireSearchApp").controller("CarCtrl",["$scope","$state","$stateParams","searchService",function(a,b,c,d){a.car=d.getCar(c.id),null===a.car&&b.go("search"),this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("hotwireSearchApp").service("searchService",["cfg","$rootScope","$state","$http","alertService",function(a,b,c,d,e){this.results=[],e.dismiss(),this.subscribe=function(a,c){var d=b.$on("search-result-change",c);a.$on("$destroy",d)},this.submit=function(f,g,h,i,j){e.dismiss(),g=("0"+(g.getMonth()+1)).slice(-2)+"/"+("0"+g.getDate()).slice(-2)+"/"+g.getFullYear(),i=("0"+(i.getMonth()+1)).slice(-2)+"/"+("0"+i.getDate()).slice(-2)+"/"+i.getFullYear(),h=("0"+h.getHours()).slice(-2)+":"+("0"+h.getMinutes()).slice(-2),j=("0"+j.getHours()).slice(-2)+":"+("0"+j.getMinutes()).slice(-2),d({method:"JSONP",url:a.apiUrl+"/search/car?apikey="+a.apiKey+"&format=jsonp&callback=JSON_CALLBACK&dest="+f+"&startdate="+g+"&enddate="+i+"&pickuptime="+h+"&dropofftime="+j}).then(function(a){if("0"===a.data.StatusCode){this.results=a.data.Result,this.types=a.data.MetaData.CarMetaData.CarTypes,this.typesDict={};for(var d=0;d<this.types.length;d++)this.typesDict[this.types[d].CarTypeCode]=this.types[d].CarTypeName;for(d=0;d<this.results.length;d++)this.results[d].CarTypeName=this.typesDict[this.results[d].CarTypeCode];b.$emit("search-result-change"),c.go("search.results")}else console.log(a),e.set(a.data.Errors.Error.ErrorMessage,"danger")}.bind(this),function(){e.set("An error occurred when contacting the server!","danger")})},this.getCar=function(a){for(var b=0;b<this.results.length;b++)if(this.results[b].HWRefNumber===a)return this.results[b];return null}}]),angular.module("hotwireSearchApp").controller("MainCtrl",["$scope","alertService",function(a,b){a.alert={message:b.message,prefix:b.prefix,"class":b["class"]},b.subscribe(a,function(){a.alert={message:b.message,prefix:b.prefix,"class":b["class"]}}),a.dismiss=function(){b.dismiss()},this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("hotwireSearchApp").service("alertService",["$rootScope",function(a){var b={danger:"Error:",warning:"Notice:"};this.message=null,this.prefix=null,this["class"]=null,this.dismiss=function(){this.message=null,this.prefix=null,this["class"]=null,a.$emit("alert-change")},this.set=function(c,d){this.message=c,this.prefix=b[d],this["class"]=d,a.$emit("alert-change")},this.subscribe=function(b,c){var d=a.$on("alert-change",c);b.$on("$destroy",d)}}]),angular.module("hotwireSearchApp").run(["$templateCache",function(a){a.put("views/car.html",'<div class="col-md-6 col-md-offset-3" ng-show="car" ng-cloak> <div class="panel panel-default"> <div class="panel-heading"> <h3 class="panel-title">{{car.CarTypeName}}</h3> </div> <a href="{{car.DeepLink}}"><button type="button" class="btn btn-primary btn-lg book">Book This Car</button></a> <table class="table"> <tbody> <tr> <td>Car Type:</td> <td>{{car.CarTypeCode}}</td> </tr> <tr> <td>Pickup Time:</td> <td>{{car.PickupDay}} {{car.PickupTime}}</td> </tr> <tr> <td>Dropoff Time:</td> <td>{{car.DropoffDay}} {{car.DropoffTime}}</td> </tr> <tr> <td>Location:</td> <td>{{car.LocationDescription}}</td> </tr> <tr> <td>Mileage Limitation:</td> <td>{{car.MileageDescription}}</td> </tr> <tr> <td>Renting for:</td> <td>{{car.RentalDays}} Days</td> </tr> <tr> <td>Daily Rate:</td> <td>{{car.DailyRate}} {{car.CurrencyCode}}</td> </tr> <tr> <td>Subtotal:</td> <td>{{car.SubTotal}} {{car.CurrencyCode}}</td> </tr> <tr> <td>Taxes and Fees:</td> <td>{{car.TaxesAndFees}} {{car.CurrencyCode}}</td> </tr> <tr> <td>Total Price:</td> <td>{{car.TotalPrice}} {{car.CurrencyCode}}</td> </tr> </tbody> </table> </div> </div>'),a.put("views/results.html",'<div class="table-responsive" ng-show="results.length" ng-cloak> <table class="table"> <thead> <tr> <td>Car Type</td> <td>Daily Rate</td> <td>TotalPrice</td> <td></td> </tr> </thead> <tbody> <tr ng-repeat="car in results"> <td>{{car.CarTypeName}}</td> <td>{{car.DailyRate}}</td> <td>{{car.TotalPrice}}</td> <td><button type="button" class="btn btn-primary btn-xs pull-right" ui-sref="search.car({id: car.HWRefNumber})">View Details <i class="fa fa-chevron-right"></i></button></td> </tr> </tbody> </table> </div>'),a.put("views/search.html",'<div class="row search"> <form ng-submit="submit()"> <div class="col-md-3 col-sm-12"> <div class="form-group"> <label for="location" class="sr-only">Location</label> <input required class="form-control" type="text" ng-model="location" id="location" placeholder="Location"> </div> </div> <div class="col-md-2 col-sm-6"> <div class="form-group input-group"> <input type="text" class="form-control" uib-datepicker-popup="MM/dd/yyyy" ng-model="dateStart.val" is-open="dateStart.opened" min-date="minDate" max-date="maxDate" ng-required="true" close-text="Close"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateStart.open()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="col-md-2 col-sm-6"> <div class="form-group"> <uib-timepicker ng-model="timeStart" hour-step="1" minute-step="30" show-meridian="true" show-spinners="false"> </uib-timepicker> </div> </div> <div class="col-md-2 col-sm-6"> <div class="form-group input-group"> <input type="text" class="form-control" uib-datepicker-popup="MM/dd/yyyy" ng-model="dateEnd.val" is-open="dateEnd.opened" min-date="minDate" max-date="maxDate" ng-required="true" close-text="Close"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateEnd.open()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="col-md-2 col-sm-6"> <div class="form-group"> <uib-timepicker ng-model="timeEnd" hour-step="1" minute-step="30" show-meridian="true" show-spinners="false"> </uib-timepicker> </div> </div> <div class="col-md-1 col-sm-12"> <button type="submit" class="btn btn-primary hidden-md search">Search</button> <button type="submit" class="btn btn-primary hidden-lg hidden-sm hidden-xs search"><i class="fa fa-search"></i></button> </div> </form> </div> <div ui-view></div>')}]);